{"version":3,"sources":["token.js"],"names":["dotenv","require","jwt","config","authenticateToken","req","res","next","authHeader","headers","token","split","sendStatus","verify","process","env","TOKEN_SECRET","err","user","generateAccessToken","customername","sign","data","expiresIn","module","exports"],"mappings":";;AAAA,IAAMA,MAAM,GAAGC,OAAO,CAAC,QAAD,CAAtB;;AACA,IAAMC,GAAG,GAAGD,OAAO,CAAC,cAAD,CAAnB,C,CAEA;;;AACAD,MAAM,CAACG,MAAP;;AAEA,SAASC,iBAAT,CAA2BC,GAA3B,EAAgCC,GAAhC,EAAqCC,IAArC,EAA2C;AACvC,MAAMC,UAAU,GAAGH,GAAG,CAACI,OAAJ,CAAY,eAAZ,CAAnB;AACA,MAAMC,KAAK,GAAGF,UAAU,IAAIA,UAAU,CAACG,KAAX,CAAiB,GAAjB,EAAsB,CAAtB,CAA5B;AAEA,MAAID,KAAK,IAAI,IAAb,EAAmB,OAAOJ,GAAG,CAACM,UAAJ,CAAe,GAAf,CAAP;AAEnBV,EAAAA,GAAG,CAACW,MAAJ,CAAWH,KAAX,EAAkBI,OAAO,CAACC,GAAR,CAAYC,YAA9B,EAA4C,UAACC,GAAD,EAAMC,IAAN,EAAe;AACvD,QAAID,GAAJ,EAAS,OAAOX,GAAG,CAACM,UAAJ,CAAe,GAAf,CAAP;AACTP,IAAAA,GAAG,CAACa,IAAJ,GAAWA,IAAX;AACAX,IAAAA,IAAI;AACP,GAJD;AAKH;;AAED,SAASY,mBAAT,CAA6BC,YAA7B,EAA2C;AACvC,SAAOlB,GAAG,CAACmB,IAAJ,CAAS;AAAEC,IAAAA,IAAI,EAAEF;AAAR,GAAT,EAAiCN,OAAO,CAACC,GAAR,CAAYC,YAA7C,EAA2D;AAAEO,IAAAA,SAAS,EAAE;AAAb,GAA3D,CAAP;AACH;;AAEDC,MAAM,CAACC,OAAP,GAAiB;AACbrB,EAAAA,iBAAiB,EAAjBA,iBADa;AAEbe,EAAAA,mBAAmB,EAAnBA;AAFa,CAAjB","sourcesContent":["const dotenv = require('dotenv');\r\nconst jwt = require('jsonwebtoken');\r\n\r\n// get password vars from .env file\r\ndotenv.config();\r\n\r\nfunction authenticateToken(req, res, next) {\r\n    const authHeader = req.headers['authorization']\r\n    const token = authHeader && authHeader.split(' ')[1]\r\n\r\n    if (token == null) return res.sendStatus(401)\r\n\r\n    jwt.verify(token, process.env.TOKEN_SECRET, (err, user) => {\r\n        if (err) return res.sendStatus(403)\r\n        req.user = user\r\n        next()\r\n    })\r\n}\r\n\r\nfunction generateAccessToken(customername) {\r\n    return jwt.sign({ data: customername }, process.env.TOKEN_SECRET, { expiresIn: '1h' });\r\n}\r\n\r\nmodule.exports = {\r\n    authenticateToken,\r\n    generateAccessToken\r\n}\r\n"],"file":"token.dev.js"}