"use strict";var Queue=require("../models/queue.model"),_require=require("express"),request=_require.request,registerQueue=function(t,r){var n,u,s,a,c,i;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body.stationname,u=t.body.arrivaltime,s=t.body.leavetime,a=t.body.status,c=t.body.vehicleType,i=new Queue({stationname:n,arrivaltime:u,leavetime:s,status:a,vehicleType:c}),e.prev=6,e.next=9,regeneratorRuntime.awrap(i.save());case 9:if(e.sent)return e.abrupt("return",r.status(201).send({message:"New customer added to the queue"}));e.next=14;break;case 14:return e.abrupt("return",r.status(500).send({message:"Internal server error"}));case 15:e.next=21;break;case 17:return e.prev=17,e.t0=e.catch(6),console.log(e.t0),e.abrupt("return",r.status(400).send({message:"Error while entering the queue"}));case 21:case"end":return e.stop()}},null,null,[[6,17]])},updateTime=function(t,r){var n,u;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.id,u={stationname:t.body.stationname,arrivaltime:t.body.arrivaltime,leavetime:t.body.leavetime,status:t.body.status,vehicleType:t.body.vehicleType},e.prev=2,e.next=5,regeneratorRuntime.awrap(Queue.findOneAndUpdate({ID:n},u));case 5:if(e.sent)return e.abrupt("return",r.status(200).send({message:"Successfully update time"}));e.next=10;break;case 10:return e.abrupt("return",r.status(500).send({message:"Internal server error"}));case 11:e.next=16;break;case 13:return e.prev=13,e.t0=e.catch(2),e.abrupt("return",r.status(400).send({message:"Unable to update"}));case 16:case"end":return e.stop()}},null,null,[[2,13]])},deletequeue=function(t,r){var n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.queueid,e.prev=1,e.next=4,regeneratorRuntime.awrap(Queue.findOneAndDelete({queueid:n}));case 4:if(e.sent)return e.abrupt("return",r.status(204).send({message:"Successfully deleted A User from queue"}));e.next=9;break;case 9:return e.abrupt("return",r.status(404).send({message:"Such user does not remove the queue"}));case 10:e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(1),e.abrupt("return",r.status(500).send({message:"Internal Server Error"}));case 15:case"end":return e.stop()}},null,null,[[1,12]])},getcount=function(t,r){var n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.vehicleType.trim(),e.prev=1,e.next=4,regeneratorRuntime.awrap(Queue.find());case 4:if(!e.sent){e.next=9;break}Queue.count({vehicleType:{$regex:"^"+n+".*",$options:"i"}}).then(function(e){r.json(e)}),e.next=10;break;case 9:return e.abrupt("return",r.status(404).send({message:"No such vehicle type found"}));case 10:e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(1),e.abrupt("return",r.status(500).send({message:"Internal Server Error"}));case 15:case"end":return e.stop()}},null,null,[[1,12]])},getcountststus=function(t,r){var n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.status.trim(),e.prev=1,e.next=4,regeneratorRuntime.awrap(Queue.find());case 4:if(!e.sent){e.next=9;break}Queue.count({status:{$regex:"^"+n+".*",$options:"i"}}).then(function(e){r.json(e)}),e.next=10;break;case 9:return e.abrupt("return",r.status(404).send({message:"No such user in the queue"}));case 10:e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(1),e.abrupt("return",r.status(500).send({message:"Internal Server Error"}));case 15:case"end":return e.stop()}},null,null,[[1,12]])};module.exports={registerQueue:registerQueue,deletequeue:deletequeue,getcount:getcount,updateTime:updateTime,getcountststus:getcountststus};
//# sourceMappingURL=queue.controller.min.js.map
